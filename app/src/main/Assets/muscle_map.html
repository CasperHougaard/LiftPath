<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <style>
        html, body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            background: transparent;
            box-sizing: border-box;
        }
        * {
            box-sizing: border-box;
        }
        #svg-container {
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        svg {
            display: block;
            width: 100%;
            height: 100%;
            max-width: 100%;
            max-height: 100%;
            margin: 0 auto;
            flex-shrink: 0;
            object-fit: contain;
        }

        /* DEFAULT STATE: Dark Grey with White Outline */
        path {
            fill: #444444 !important;
            stroke: #ffffff !important;
            stroke-width: 2px !important;
            transition: fill 0.3s ease;
        }

        /* ACTIVE STATE: Bright Red (Triggered by Kotlin) */
        .active path,
        path.active {
            fill: #FF3B30 !important;
        }
        
        g.active path {
            fill: #FF3B30 !important;
        }
    </style>
</head>
<body>

    <!-- Load SVG using object tag (most reliable for Android WebView) -->
    <object id="svg-object" data="liftpath_musclegroups.svg" type="image/svg+xml" style="width: 100%; height: 100%;"></object>

    <script>
        // Wait for SVG object to load, then access its content
        const svgObject = document.getElementById('svg-object');
        let svgDoc = null;
        
        function setupSVG() {
            try {
                svgDoc = svgObject.contentDocument;
                if (!svgDoc) {
                    // Try again after a short delay
                    setTimeout(setupSVG, 100);
                    return;
                }
                
                const svg = svgDoc.querySelector('svg');
                if (svg) {
                    // Set preserveAspectRatio to maintain aspect ratio and center
                    svg.setAttribute('preserveAspectRatio', 'xMidYMid meet');
                    // Ensure SVG fills container
                    svg.setAttribute('width', '100%');
                    svg.setAttribute('height', '100%');
                }
            } catch (e) {
                console.error('Error accessing SVG content:', e);
                // Fallback: try XMLHttpRequest
                loadSVGFallback();
            }
        }
        
        // Fallback method using XMLHttpRequest
        function loadSVGFallback() {
            const xhr = new XMLHttpRequest();
            xhr.open('GET', 'liftpath_musclegroups.svg', true);
            xhr.onreadystatechange = function() {
                if (xhr.readyState === 4 && (xhr.status === 200 || xhr.status === 0)) {
                    const container = document.createElement('div');
                    container.id = 'svg-container';
                    container.style.cssText = 'width: 100%; height: 100%;';
                    document.body.appendChild(container);
                    container.innerHTML = xhr.responseText;
                    
                    document.querySelectorAll('svg').forEach(svg => {
                        if (!svg.hasAttribute('viewBox')) {
                            const width = svg.getAttribute('width');
                            const height = svg.getAttribute('height');
                            if (width && height) {
                                const widthNum = parseFloat(width.replace('px', '').replace('pt', '').replace('%', ''));
                                const heightNum = parseFloat(height.replace('px', '').replace('pt', '').replace('%', ''));
                                if (!isNaN(widthNum) && !isNaN(heightNum)) {
                                    svg.setAttribute('viewBox', `0 0 ${widthNum} ${heightNum}`);
                                }
                            }
                        }
                        svg.setAttribute('preserveAspectRatio', 'xMidYMid meet');
                        svg.setAttribute('width', '100%');
                        svg.setAttribute('height', '100%');
                    });
                    
                    // Remove object tag
                    svgObject.remove();
                }
            };
            xhr.send(null);
        }
        
        // Try to setup when object loads
        svgObject.addEventListener('load', setupSVG);
        
        // Also try immediately in case it's already loaded
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', setupSVG);
        } else {
            setTimeout(setupSVG, 100);
        }
w
        // Kotlin calls this function: setHighlights(['BICEPS', 'TRICEPS_LONG'])
        function setHighlights(idsArray) {
            // Get the SVG document (either from object or main document)
            let doc = document;
            if (svgDoc) {
                doc = svgDoc;
            }
            
            // 1. Reset all paths and groups to default
            doc.querySelectorAll('path, g').forEach(el => el.classList.remove('active'));

            // 2. Highlight target muscles (works with both path and group elements)
            idsArray.forEach(id => {
                const el = doc.getElementById(id);
                if(el) {
                    el.classList.add('active');
                    // If it's a group, also add active class to its paths
                    if(el.tagName === 'g') {
                        el.querySelectorAll('path').forEach(p => p.classList.add('active'));
                    }
                }
            });
        }
    </script>
</body>
</html>